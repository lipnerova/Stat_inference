---
title: "project_tooth"
author: "lipnerova"
date: "December 21, 2015"
output: pdf_document
---
#Report
## Overview
This study analyse the ToothGrowth data in the R datasets package, aiming for comparing benefits of two diets on growth of teeth. The goals are to provide simple exploratory data analysis, compare two diets and draw a conclusion based on performed tests.

The data contains measurements of the length of odontoblasts (cells responsible for tooth growth) in 60 guinea pigs. Animals were divided to 6 groups per 10 pigs, each group was fed with one of two supplements, orange juice (OJ) or ascorbic acid (vitami C, VC), in one of three doses (0.5, 1, or 2 mg/day). The output data has format of 60 observations and 3 variables - __len__ for length of odontoblasts, __sup__ for supplement type, and __dose__ for dose recieved.

## Loading the data

```{r libraries, message=FALSE, warning=FALSE}
# Load libraries
library(dplyr); library(ggplot2); library(gridExtra); library(knitr)

# Load dataset
library(datasets)   
data(ToothGrowth)
a<-(ToothGrowth) #give it easily typed name
```


# EDA

```{r boxplots}
p1 <- ggplot(a, aes(y=len, x=as.factor(supp))) + 
  geom_boxplot(aes(fill=supp)) + 
  guides(fill=FALSE) +
  facet_grid(.~dose) +
  labs(title="Teeth growth on two supplements 
       \n by dose (mg/day) of supplement",
       x="Supplement type",
       y="Length of teeth") +
  theme(title = element_text(size = rel(0.75), hjust = 0.5))


p2 <- ggplot(a, aes(x=supp, y=len)) + geom_boxplot(aes(fill=supp)) + 
  labs(title="Overall teeth growth \n on two supplements",
       x="Supplement type",
       y="Length of teeth") +
  scale_fill_discrete(name="Supplement",
                      labels=c("Orange juice", "Vitamin C")) +
  theme(title = element_text(size = rel(0.75), hjust = 0.5))

# Arrange them: 
grid.arrange(p1, p2, ncol=2, nrow=1)
```

```{r tab_one}
a_tab<-group_by(a, supp, dose) %>% summarise(mean(len))
kable(x=a_tab, digits=1, align="c", caption="Summary table of data")
```


# Testing

Test hypothesis, that there is a difference between orange juice and vitamin C (all doses together.
Test each dose separately for above stated difference => together 4 tests.

## Hypotheses

I decide to test the difference in teeth growth between supplementing orange juice (OJ) and vitamin C (VC). I use R function _t-test_. Based on EDA I suppose that orange juice gives better results.

__Assumptions for testing:__
* Guinea pigs were selected randomly and each combination of dose and supplement fed to different group of pigs, thus they form independent groups (_paired=FALSE_ as a default of t.test)
* Lengths of odontoblasts are normal for tested sets of data (see Appendix for testing normality)
* No info about variance, thus for sake of correctnes t.tests default _var.equal=FALSE_ is used
 
  
__Overall test:__

$\sf{H_{0}}$: there is no difference between OJ and VC

$\sf{H_{a}}$: the OJ has bigger effect than VC


__Partial tests for each dose:__

$\sf{H_{0}}$: there is no difference between OJ and VC for set dose level (e.g., 0.5, 1, and 2 mg/day).

$\sf{H_{a}}$: the OJ has bigger effect than VC for set dose level

```{r tests}
# Prepare table of results:
test_res <- NULL

# Test OJ vs VC overall:  
test_res<-cbind(t.test(len ~ factor(supp), data=a, paired=F)$p.value, 
    t.test(len ~ factor(supp), data=a, paired=F)$conf.int[1],
    t.test(len ~ factor(supp), data=a, paired=F)$conf.int[2])

# Test OJ vs VC for each dose:  
for (i in c(0.5, 1, 2)) {
    test_res <- rbind(test_res, 
                cbind(t.test(len ~ factor(supp), data=a[a$dose== i, ], 
                             paired=F)$p.value, 
                      t.test(len ~ factor(supp), data=a[a$dose== i, ], 
                             paired=F)$conf.int[1],
                      t.test(len ~ factor(supp), data=a[a$dose== i, ], 
                             paired=F)$conf.int[2]
                      )
                      )
  }

# Format table of results:    
test_res<-as.data.frame(test_res)
row.names(test_res)<-c("OJ vs VC overall", "OJ vs VC - dose 0.5", 
              "OJ vs VC - dose 1.0", "OJ vs VC - dose 2.0")
colnames(test_res)<-c("p-value", "95% CI (-)", "95% CI (+)")

# Print table of results:
kable(test_res, digits=3, row.names=T, align="c", 
      caption="Summary table of test results")
```

There is no statistically significant overall difference between orange juice and vitamin C, however for lower doses (0.5 mg/day and 1 mg/day) the orange juice gives has more prominent effect on growt of guinea pigs odontoblasts. High dose of 2 mg/day of one or other supplement is sufficient to achieve maximum odontoblasts growth, e.g. such a dose of vitamin C is high enough to compensate for whichever advantage the orange juice has at lower dose levels.


# Appendix
```{r normality, eval=F}
shapiro.test(a$len[a$supp=="OJ" & a$dose == 0.5]) #norm
shapiro.test(a$len[a$supp=="OJ" & a$dose == 1]) #norm
shapiro.test(a$len[a$supp=="OJ" & a$dose == 2]) #norm
shapiro.test(a$len[a$supp=="VC" & a$dose == 0.5]) #norm
shapiro.test(a$len[a$supp=="VC" & a$dose == 1]) #norm
shapiro.test(a$len[a$supp=="VC" & a$dose == 2]) #norm
shapiro.test(a$len[a$supp=="OJ"]) #norm
shapiro.test(a$len[a$supp=="VC"]) #norm
shapiro.test(a$len) #norm
```